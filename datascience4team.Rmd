---
title: "2014-2016년 여행지별 국내여행 참여자 수"
output: html_document
---

### <서론>

근래의 국내 여행 시장 약화 추세로 인해 국내 여행 진흥을 위한 다양한 시도가 이루어지고 있다. 그만큼 실질적인 국내 여행 참가자들의 데이터의 중요성도 높아졌기에 이를 알아봄으로써 국내 여행자들의 특성에 대해 파악을 할 수 있다. 본 보고서는 국내의 여러 지역으로 여행하는 여행자들은 어떤 특성이 있는지 알아보고, 다양한 특성들에 따른 여행자의 수와의 관계를 분석하고자 한다. 모든 분석은 "연도 및 지역별"을 기준으로 하였고, "성별-여행자 수의 관계", "연령-여행자 수의 관계", "직업-여행자 수의 관계", "가구소득-여행자 수의 관계 ", "학력-여행자 수의 관계"의 순서로 분석하였다.

성별 비교에서는 대체로 모든 연도에서 여성이 국내 여행 참가가 압도적으로 많다고 볼 수 있다는 결과가 나왔다. 연령에서는 연도별로 연령이 높을수록 국내 여행 참여가 많은 것으로 나타났다. 소득 측면에서도 연도별로 보았을 때, 대체로 소득이 높을수록 여행자의 수가 높았지만, 세종의 경우 다른 지역에 비해 `300~400만 원 미만`의 가구소득에 해당하는 여행자 수가 많았다. 직업에서는 연도별로는, 전문직인 여행자가 많이 나타났고, 광주의 경우 다른 지역에 비해 `농어업`직업군이 높은 비율로 나타났다. 학력 측면에서는 연도별로는, 고등학교를 졸업한 학력의 여행자 수와 대학교를 졸업한 학력의 여행자 수가 다른 학력에 비해 현저히 높은 수치를 보였고, 세종시를 방문한 사람들의 비율에서는 전문대학을 졸업한 사람들의 비율이 2번째로 높게 나타났다.

결론적으로 본 보고서에서는, 성별의 특징에서는 어떤 년도 및 어떤 지역에서 남성의 수가 많은지 여성의 수가 많은지 파악할 수 있다. 소득과 연령 같은 수치가 있는 변수들에서는 대체로 값이 커질수록 여행자의 수가 많이 나타났지만, 직업이나 학력 같은 경우는 특정 분야에서의 여행자의 수가 많이 나타났다는 것을 알아볼 수 있다.

#### 데이터

- 선정 이유 : 해외여행 데이터에 비교했을 때 국내 여행은 상대적으로 통계 내용이 국민들에게 잘 알려지지 않았기 때문에 해당 데이터를 선정했다. 또한, 해당 데이터에는 성별, 지역, 가구 소득 등과 같은 다양한 내용이 들어있기 때문에 선정하게 되었다.

- 출처 : 국가통계포털(KOSIS) 제공(국내통계-기관별 통계-중앙행정기관-문화체육관광부-국민여행 실태조사-여행 경험률 및 여행참가 횟수-여행지별 국내여행 참가자 수(2014~2016))

- 구성 : 2014년부터 2016년까지의 국내여행 참가자들을 대상으로 한 데이터이다. 대한민국 전국 시도별 국내 여행 참가자 수를 통계분류(1)와 그 하위항목 분류인 통계분류(2)로 자세히 나누었다.

1. 국내 여행지(17곳) : 서울, 부산, 대구, 인천, 광주, 대전, 울산, 세종, 경기, 강원, 충북, 충남, 전북, 전남, 경북, 경남, 제주
2. 성별 (남자, 여자)
3. 연령(15세~19세, 20대, 30대, 40대, 50대, 60대 이상)
4. 직업(전문관리, 사무, 서비스판매, 농어업, 기능 노무)
5. 가구소득(50만 원 미만, 50만~100만 원 미만, 100만~200만 원 미만, 200만~300만 원 미만, 300만~400만 원 미만, 400만~500만 원 미만, 500만~600만 원 미만, 600만 원 이상)
6. 학력(초졸 이하, 중학교(재/졸), 고등학교(재/졸), 전문대(재/졸), 대학교(재/졸), 대학원(재/졸)

- 조사대상 범위 및 지역 : 가구 내 만 15세 이상 모든 가구원 조사 / 전국

- 조사주기 : 1년

###<본론_분석>
데이터 불러오기
---------------

먼저 분석에 필요한 패키지를 로드한다. 데이터를 불러오기 위한 `readxl` 패키지와 구문 작성 및 그래프 작성에 필요한 `dplyr`, `ggplot2` 패키지를 로드한다.


``` {r}
library(ggplot2)
library(dplyr)
library(readxl)
```

다음으로 데이터를 불러온다. `read_excel()`을 이용해 데이터를 불러온 뒤, 데이터 sheet를 사용하고, 첫 번째 행이 변수명이었으므로 `col_names`는 `T`로 입력한다.

``` {r}
travel <- read_excel("travel2.xlsx", sheet=1, col_names = T)
travel
```

 
불러온 데이터가 어떤 속성을 가지고 있는지, 결측치가 있는지 `str()`함수와 `table(is.na())`를 이용하여 확인한 후 데이터 훼손을 막기 위해 복사한다.

``` {r}
str(travel)
```
    

``` {r}
travel_new1 <- travel
```



### [1] 연도 및 지역별 성별-여행자 수의 관계 분석

분석에 앞서 필요없는 행과 열을 정리한 뒤 `View()` 함수를 이용해 데이터를 확인한다.

``` {r}
travel_new1 <- travel_new1[c(1:4),]
travel_new1 <- travel_new1[,-c(1)]            
View(travel_new1)                     
```

`c()`함수를 이용해 성별, 지역 및 연도 데이터를 입력한다.

``` {r}
man <- c(5679692,3186234,1704851,2085968,1158819,1508478,830784,209194,7186353,5990236,2368343,4799826,3622001,3445811,4684999,4670726,1651470,5936500,3480070,1507886,1990424,985757,1433309,781214,94068,7334898,5663455,2322692,4783462,3230798,3834223,4191480,4148802,2074122,6153648,3481215,1600432,2566923,1163528,1682066,995151,362288,7985308,5747317,2583590,4865165,3501966,4232213,3961299,4538624,2208882)

woman <- c(6900889,3478939,1849836,2378224,1104298,1615149,956889,157691,8097374,6292723,2843721,4958422,4209072,3884633,4943875,5018457,2026254,6515391,3678483,1655275,2416639,1149575,1551620,851196,239261,8116857,5895550,2818418,5161154,3530032,4229315,4630721,4330765,2658372,7084206,3932941,1537255,2853783,1237716,1815821,1048806,378422,8841398,5935906,2995599,5327268,4209060,4847903,4698537,4943734,2621070)

region <- c("서울","부산","대구","인천","광주","대전","울산","세종","경기","강원","충북","충남","전북","전남","경북","경남","제주","서울","부산","대구","인천","광주","대전","울산","세종","경기","강원","충북","충남","전북","전남","경북","경남","제주","서울","부산","대구","인천","광주","대전","울산","세종","경기","강원","충북","충남","전북","전남","경북","경남","제주")

year <- c("2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2014","2015","2015","2015","2015","2015","2015","2015","2015","2015","2015","2015","2015","2015","2015","2015","2015","2015","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016")
```

위에서 생성한 변수들을 `data.frame()` 함수를 이용하여 새로운 데이터 프레임을 만든다. 제대로 만들어졌는지 확인하기 위해 `head()` 함수를 이용한다.

``` {r}
df_travel <- data.frame(man,woman,region,year)      
df_travel
```


``` {r}
head(df_travel)
```

  
`group_by()`를 이용해 지역과 연도를 중심으로 분리한 뒤 `summarise()`를 통해 성별에 따른 여행자수 평균값을 구한다.

``` {r}
a <- df_travel %>%
  group_by(region, year) %>%  
  summarise(mean_man = mean(man), mean_woman = mean(woman))      
```

`mutate()`를 이용해 평균값이 큰 성별(man\_larger, woman\_larger), 성별 평균값 합(mean\_all)을 뜻하는 파생변수를 추가한다. 제대로 생성되었는지 확인하기 위해 `View()`를 이용한다.

``` {r}
b <- a %>% 
  mutate(compare = ifelse(mean_man>mean_woman, "man_larger", "woman_lager"), mean_all = (mean_man+mean_woman)) ##위 데이터에서 파생변수 추가(평균값이 큰 성별, 성별 평균값 합)
View(b)
```

연도별 변화를 알아보기 위해 `filter()`를 이용해 연도를 분리한다.

``` {r}
year_compare2014 <- b %>% 
  filter(year == "2014")   ##2014년

year_compare2015 <- b %>% 
  filter(year == "2015")   ##2015년

year_compare2016 <- b %>% 
  filter(year == "2016")   ##2016년
```

연도별로 분리한 데이터를 시각화 위해 막대그래프로 생성한다. `x축`은 지역, `y축`은 성별 평균합, `fill`은 성별로 지정한다.

``` {r}
ggplot(data=year_compare2014, aes(x=region, y=mean_all, fill=compare))+
  geom_col()+
  scale_x_discrete(limits=c("서울","부산","대구","인천","광주","대전","울산","세종","경기","강원","충북","충남","전북","전남","경북","경남","제주"))
```


``` {r}
ggplot(data=year_compare2015, aes(x=region, y=mean_all, fill=compare))+
  geom_col()+
  scale_x_discrete(limits=c("서울","부산","대구","인천","광주","대전","울산","세종","경기","강원","충북","충남","전북","전남","경북","경남","제주"))
```



``` {r}
ggplot(data=year_compare2016, aes(x=region, y=mean_all, fill=compare))+
  geom_col()+
  scale_x_discrete(limits=c("서울","부산","대구","인천","광주","대전","울산","세종","경기","강원","충북","충남","전북","전남","경북","경남","제주"))
```



지역별 성별에 따른 여행자 차이를 각 연도별로 비교해 본 결과는 다음과 같다. 어떤지역에서 어떤 성별의 사람이 많이 방문했는지를 나타낸 결과이다. 

2014년 지역별 성별에 따른 여행자 차이
남성 우위 지역 : 광주, 세종
여성 우위 지역 : 경기, 서울, 강원, 충남, 경북, 경남, 전북, 전남, 부산, 충북, 인천, 제주, 대구, 대전, 울산

2015년 지역별 성별에 따른 여행자 차이
남성 우위 지역 : 없음
여성 우위 지역 : 경기, 서울, 강원, 충남, 경북, 경남, 전남, 부산, 전북, 충북, 제주, 인천, 대구, 대전, 광주, 울산, 세종 

2016년 지역별 성별에 따른 여행자 차이
남성 우위 지역 : 대구
여성 우위 지역 : 경기, 서울, 강원, 충남, 경남, 전남, 경북, 전북, 부산, 충북, 인천, 제주, 대전, 광주, 울산, 세종

이 결과는 모든 연도에서 경기, 서울, 강원, 충남 지역의 경우 국내 여성 여행자 순위가 고정되어 있는 지역이고, 대체로 모든 연도에서 여성이 국내 여행 참가가 압도적으로 많다고 볼 수 있다.


### [2] 연도 및 지역별 연령-여행자 수의 관계 분석

새로운 분석을 위해 raw 데이터를 새로 복사한 뒤 `table(is.na())`를 이용해 결측치가 있는지 확인한다.

``` {r}
travel_new2 <- travel

table(is.na(travel$`2014`))
```

``` {r}
table(is.na(travel$`2015`))
```

``` {r}
table(is.na(travel$`2016`))
```


출력 결과 결측치가 없다는 것을 알 수 있다. `c()`함수를 이용해 필요한 행을 추출한 뒤

``` {r}
age <- travel_new2[c(52:153),]

teens <- age[c(1:17),] #15~10세
twenty <- age[c(18:34),] #20대
thirty <- age[c(35:51),] #30대
forty <- age[c(52:68),] #40대
fifty <- age[c(69:85),] #50대
over_sixty <- age[c(86:102),] #60대 이상
```

추출한 행에서 `select()`함수를 통해 연도를 추출하고 `sum`을 이용해 연령별 여행자 수 합을 구한다.

``` {r}
teens <- teens %>%
  select('2014', '2015', '2016') %>% 
  sum
twenty <- twenty %>% 
  select('2014', '2015', '2016') %>% 
  sum
thirty <- thirty %>% 
  select('2014', '2015', '2016') %>% 
  sum
forty <- forty %>%
  select('2014', '2015', '2016') %>% 
  sum
fifty <- fifty %>% 
  select('2014', '2015', '2016') %>% 
  sum
over_sixty <- over_sixty %>% 
  select('2014', '2015', '2016') %>% 
  sum
```

`c()`함수를 이용해 `population`변수를 추가한 뒤 `data.frame()`함수를 통해 새로운 데이터 프레임을 만든다.

``` {r}
population <- c(teens, twenty, thirty, forty, fifty, over_sixty) #population 변수 추가하기
age <- rep(c('teens', 'twenty', 'thirty', 'forty', 'fifty', 'over_sixty'), each=1)

df <- data.frame(population, age)
df
```


새로 만든 데이터 프레임을 시각화 하기 위해 `x축`은 age, `y축`은 population으로 지정한 막대그래프를 생성한다. `ggtitle()`함수를 이용해 그래프 제목을 넣어준다.

``` {r}
ggplot(data = df, aes(x= reorder(age, -population), y= population, fill = population)) +
  geom_col() +
  ggtitle("연령별 국내 여행자 수")
```


그래프에서 살펴볼 수 있듯이 연령이 높을수록 국내 여행 참여가 많은 것으로 나타났다. 반면에 연령이 낮은 나이는 연령은 상대적으로 나이가 높은 연령보다 국내 여행자 수가 적게 나왔다. 이는 연령이 높아질수록 소득이 증가하는 보편적인 경향을 띄고 있다는 속설을 잘 증명해 주고, 소득이 높아질수록 여행자 수도 역시 함께 보여주고 있다.



### [3] 연도 및 지역별 직업-여행자 수의 관계 분석

위와 같이 데이터를 새로 복사한 뒤 `rename()`함수를 이용해 데이터의 변수명을 영어 변수명으로 바꾼다.

``` {r}
travel_new3 <- travel

travel_new3 <- rename(travel_new3, sta1="통계분류(1)",
                     sta2="통계분류(2)",
                     area="항목",
                     year_2014="2014",
                     year_2015="2015",
                     year_2016="2016")

str(travel_new3)
```


다음은 `NA`으로 처리된 공간에 대해 그에 알맞는 내용을 지정해주고자 한다. `sta1` 변수에서는 대분류 통계로 총합, 성별, 연령, 직업, 소득, 학업에 대해 분류가 되어 있다. `NA`부분에 각 통계 분류에 맞는 내용을 할당한다. `sta2'변수에서는 소분류 통계로 총합 대분류에 소계 소분류가 이뤄지고, 성별 대분류에 남,여 소분류, 연령대분류에 6가지의 연령 소분류, 직업 대분류에는 5가지의 소분류, 소득 대분류에는 8가지 소분류, 학업 대분류에 6가지의 소분류가 이뤄지고 있다. 그에 맞춰 각 부분에 맞는 내용을 할당한다.

``` {r}
travel_new3$sta1[1:17] <- "total"
travel_new3$sta1[18:51] <- "sex"
travel_new3$sta1[52:153] <- "age"
travel_new3$sta1[154:238] <- "job"
travel_new3$sta1[239:374] <- "money"
travel_new3$sta1[375:476] <- "school"

travel_new3$sta2[1:17] <- "subtotal"
travel_new3$sta2[18:34] <- "male"
travel_new3$sta2[35:51] <- "female"
travel_new3$sta2[52:68] <- "15-19"
travel_new3$sta2[69:85] <- "20's"
travel_new3$sta2[86:102] <- "30's"
travel_new3$sta2[103:119] <- "40's"
travel_new3$sta2[120:136] <- "50's"
travel_new3$sta2[137:153] <- "60's"
travel_new3$sta2[154:170] <- "전문관리"
travel_new3$sta2[171:187] <- "사무"
travel_new3$sta2[188:204] <- "서비스판매"
travel_new3$sta2[205:221] <- "농어업"
travel_new3$sta2[222:238] <- "기능노무"
travel_new3$sta2[239:255] <- "50"
travel_new3$sta2[256:272] <- "50-100"
travel_new3$sta2[273:289] <- "100-200"
travel_new3$sta2[290:306] <- "200-300"
travel_new3$sta2[307:323] <- "300-400"
travel_new3$sta2[324:340] <- "400-500"
travel_new3$sta2[341:357] <- "500-600"
travel_new3$sta2[358:374] <- "600"
travel_new3$sta2[375:391] <- "초졸이하"
travel_new3$sta2[392:408] <- "중학교(재/졸)"
travel_new3$sta2[409:425] <- "고등학교(재/졸)"
travel_new3$sta2[426:442] <- "전문대(재/졸)"
travel_new3$sta2[443:459] <- "대학교(재/졸)"
travel_new3$sta2[460:476] <- "대학원(재/졸)"
```

데이터를 수정한 결과는 아래와 같다.

``` {r}
str(travel_new3)
```


``` {r}
head(travel_new3,10)
```

``` {r}
View(travel_new3)
```

#### 1. 직업별 연도에 따른 국내 여행자수 평균 비교

직업별 데이터를 중심으로 `여행지별 국내여행 횟수(2014~)` 데이터를 분석하고자 한다. 이 데이터 안에는 2014년부터 2016년까지의 데이터를 수록하고 있다. 이를 바탕으로 년도별로 어느 직업군의 여행자가 여행을 많이하고 있는지 파악하고자 한다. 또한 너무 큰 수를 제한하고, 평균적인 여행 횟수를 파악하기 위해 여행자 수는 평균 여행자수를 이용한다.

##### 데이터 가공하기

직업을 중심으로 하는 제한된 데이터를 사용하고, 평균 여행자 수를 사용하기 때문에 그에 맞는 데이터로 가공해야한다. `dplyr`패키지를 이용하여 데이터를 가공하고자 한다. 우선 `sta1`변수에서 `job`이 포함된 내용만 추출하기 위해 `filter()`함수를 이용한다. 그 뒤 `sta2`를 이용하여 직업군별로 묶고 `summarise()`함수를 이용하여 년도별 여행 횟수 총합과 평균을 구한다.

``` {r}
library(dplyr)

job <- travel_new3 %>% 
filter(sta1 == "job") %>% 
group_by(sta2) %>% 
select(sta2, year_2014, year_2015, year_2016) %>% 
summarise(sum_2014=sum(year_2014),
sum_2015=sum(year_2015),
sum_2016=sum(year_2016),
mean_2014=mean(year_2014),
mean_2015=mean(year_2015),
mean_2016=mean(year_2016))
```

데이터를 가공한 결과는 아래와 같다.

``` {r}
job
```


위의 결과에서 확인할 수 있듯이 `job`데이터는 `x`축 직업군을 기준으로 `y`축에 각각의 년도별 평균값을 넣는 그래프로 사용할 수 있다. 하지만 2014~2016년의 결과를 한번에 볼 수 있는 그래프를 만들기 원하기 때문에 아래와 같은 새로운 데이터를 가공하고자 한다. `job_year`데이터는 직업, 년도, 총합, 평균 4가지의 변수로 구성하며, 각각의 벡터는 `job`데이터를 이용한다.

``` {r}
job_year <- data.frame(job= c("기능노무","농어업","사무","서비스판매","전문관리","기능노무","농어업","사무","서비스판매","전문관리","기능노무","농어업","사무","서비스판매","전문관리"),
year= c(2014,2014,2014,2014,2014,2015,2015,2015,2015,2015,2016,2016,2016,2016,2016),
sum= c(9511177,6270613,20872978,16667801,9481899,9494216,5860472,23108019,16992868,9629263,8971218,6601336,25680678,18204393,9849370),
mean= c(559481.0,368859.6,1227822.2,980458.9,557758.8,558483.3,344733.6,1359295.2,999580.5,566427.2,527718.7,388313.9,1510628.1,1070846.6,579374.7))
```

결과는 다음과 같다.

``` {r}
job_year
```


##### 그래프로 나타내기

위에서 가공한 데이터를 한눈에 파악하기 위해 `ggplot2`패키지를 이용하여 그래프를 만들고자 한다. 직업별 평균를 파악하기 위해 `geom_col()`형태의 평균빈도막대그래프를 사용한다.

``` {r}
library(ggplot2)
ggplot(data = job_year, aes(x=job, y=mean, fill=year)) + geom_col()
```


위의 그래프에서는 직업별 년도에 따른 평균 여행자 수를 파악할 수 있다. 전체적으로 그래프로 보았을 때, "사무", "서비스판매", " 전문관리", "기능노무", "농어업" 순으로 평균 여행자의 수가 크게 나타났다. 그 안에서 년도별로 파악했을 때, 년도에 따라 여행자 수가 증가하지는 않으며 대체적으로 비슷한 크기의 평균 여행자 수가 나타난다는 것을 파악할 수 있었다. 결과적으로 이 그래프를 통해 전문직인 여행자가 많으며 단순 노동과 농어업의 여행자의 수는 적다는 사실을 파악할 수 있었다.

#### 2. 직업별 여행지에 따른 국내 여행자 수의 비율 비교

직업별 데이터를 중심으로 `여행지별 국내여행 횟수(2014~)` 데이터를 분석하고자 한다. 이 데이터 안에는 17개의 시, 도의 여행지가 수록되어 있으며 그에 따른 여행 횟수가 나타나 있다. 이를 바탕으로 여행지별로 어느 직업군의 여행자가 여행을 많이하고 있는지 파악하고자 한다. 여기서는 한 지역의 여행 횟수를 100%로 하는 직업별 여행지에 따른 국내 여행자 수의 비율을 비교하고자 한다.

##### 데이터 가공하기

직업을 중심으로 하는 제한된 데이터를 사용하고, 지역에 따른 여행 횟수의 비율를 사용하기 때문에 그에 맞는 데이터로 가공해야한다. `dplyr`패키지를 이용하여 데이터를 가공하고자 한다. 우선 `sta1`변수에서 `job`이 포함된 내용만 추출하기 위해 `filter()`함수를 이용한다. 그 뒤 `group_by()`를 이용해 지역별로 묶은 뒤 `mutate()`함수를 이용하여 지역별 총 여행 횟수를 나타내는 `tot_area`와 지역별 여행 횟수 비율을 나타내는 `ratio` 두 변수를 생성한다.

``` {r}
library(dplyr)

job2 <- travel_new3 %>% 
filter(sta1 == "job") %>% 
group_by(area) %>% 
select(area,sta2, year_2014, year_2015, year_2016) %>% 
mutate(tot_area=sum(year_2014,year_2015,year_2016),
ratio=(year_2014+year_2015+year_2016)/tot_area*100) %>% 
arrange(area)
```

데이터 가공 결과, 지역을 중심으로하여 지역별 총합과 지역별 여핼 횟수 비율을 나타내는 변수가 생성됐음을 확인할 수 있다.

``` {r}
job2
```

  

##### 그래프로 나타내기

위에서 가공한 데이터를 한눈에 파악하기 위해 `ggplot2`패키지를 이용하여 그래프를 만들고자 한다. `x`축에는 지역, `y`축에는 비율을 나타내고, 직업에 따라 색깔을 다르게 표현할 수 있는`fill`파라미터를 이용한다. 추가적으로 비율 그래프를 더 깔끔하게 보이게 하기 위해 `x`축과 `y`축의 위치를 변경하는 `coor_flip()`를 이용한다.

``` {r}
ggplot(data = job2, aes(x=area, y=ratio, fill=sta2)) + geom_col() + coord_flip()
```



나타난 결과 그래프를 보면 지역에 따라 대체적으로 비숫한 직업별 여행 비율이 나타난 다는 것을 확인할 수 있었다. 그중 광주의 경우 다른 지역에 비해 `농어업`직업군이 높은 비율로 나타났다. 그에 따라 광주의 위치지도와 특징을 살펴볼 때 이 지역의 경우 주변에 농경지가 많이 위치해 있는 호남지방에 위치한 것으로 보아 주변 농어업 종사자들이 여행을 많이 오기 때문에 높은 것으로 파악할 수 있었다.

###[4] 연도 및 지역별 가구소득-여행자 수의 관계 분석

위에서 사용한 `travel_new3`을 이용한 새로운 분석을 시작한다. 이번에는 가구소득이 여행자 수와 관련이 있는지 확인하기 위한 분석이다.

#### 1. 가구소득별 연도에 따른 국내 여행자수 평균 비교

가구소득 데이터를 중심으로 `여행지별 국내여행 횟수(2014~2016)` 데이터를 분석하고자 한다. 연도별로 가구소득이 국내 여행자 수에 영향을 미치는지 확인하고자 한다. 극단치를 제외하고 평균적인 인원을 파악하기 위해 여행자 수는 평균 여행자 수를 이용한다.

##### 데이터 가공하기

가구소득을 중심으로 하는 제한된 데이터를 사용하고, 평균 여행자 수를 사용해야 하므로 `filter()`함수를 이용해 `sta1`에서 income`을 추출한다. 이후 가구소득별로 묶고`summarise()`함수를 이용하여 연도별 여행자 수 총합과 평균을 구한다.

``` {r}
income <- travel_new3 %>% 
  filter(sta1 == "income") %>% 
  group_by(sta2) %>% 
  select(sta2, year_2014, year_2015, year_2016) %>% 
  summarise(sum_2014=sum(year_2014),
            sum_2015=sum(year_2015),
            sum_2016=sum(year_2016),
            mean_2014=mean(year_2014),
            mean_2015=mean(year_2015),
            mean_2016=mean(year_2016))

income
```

출력된 결과에서 확인할 수 있듯이 `income`데이터는 `x`축 가구소득을 기준으로 `y`축에 각각의 연도별 평균값을 넣는 그래프로 사용할 수 있다. 하지만 2014~2016년의 결과를 한번에 볼 수 있는 그래프를 만들기 위해 아래와 같은 새로운 데이터를 가공한다.

``` {r}
income_year <- data.frame(income= rep(c("50만원미만", "50-100만원미만", "100-200만원미만", "200-300만원미만", "300-400만원미만", "400-500만원미만", "500-600만원미만", "600만원이상"), 3),
                          year= rep(c(2014,2015,2016), each=8),
                          sum= c(2208871,3562220,11044824,21130463,20176370,19686333,18438357,19252793,1785478,3296903,12238329,20118824,18003502,19872386,18799445,19106917,1314418,4171032,11034636,20082014,24345996,21158481,18960888,20871578),
                          mean= c(129933.6,129933.6,649695.5,1242968.4,1186845.3,1158019.6,1084609.2,1132517.2,105028.1,193935.5,719901.7,1183460.2,1059029.5,1168963.9,1105849.7,1123936.3,77318.71,245354.82,649096.24,1181294.94,1432117.41,1244616.53,1115346.35,1227739.88))

income_year
```

    
##### 그래프로 나타내기

가구소득별 평균 국내 여행자 수를 파악하기 위해 `ggplot2`를 로드한 뒤 `geom_col()` 함수를 이용해 평균빈도막대그래프를 만든다. `x축`에는 가구소득(income), `y축`에는 평균 국내 여행자 수(mean)을 지정하고 `fill` 파라미터를 사용하여 연도별로 색이 다르게 표현되게 한다. 또한 `scale_x_discrete(limits=c())`를 이용해 income의 순서를 바꾼다. 마지막으로 `ggtitle()`을 이용해 그래프 제목을 넣어준다.

```{r}
library(ggplot2) 
ggplot(data = income_year, aes(x=income, y=mean, fill=year)) + geom_col()+ scale_x_discrete(limits=c("50만원미만", "50-100만원미만", "100-200만원미만", "200-300만원미만", "300-400만원미만", "400-500만원미만", "500-600만원미만", "600만원이상"))+ ggtitle('연도에 따른 소득-평균 여행자 수')
```



#### 2. 가구소득별 여행지에 따른 국내 여행자 수의 비율 비교

##### 데이터 가공하기

`filter()`함수를 이용해 `sta1`에서 `가구소득(income)`을 추출한다. 그 뒤 `group_by()`를 이용해 지역(area)별로 묶은 뒤 `mutate()`함수를 이용하여 지역별 총 여행자 수를 나타내는 `tot_area`와 지역별 여행자 수 비율을 나타내는 `ratio` 두 변수를 생성한다.

``` {r}
income2 <- travel_new3 %>% 
  filter(sta1 == "income") %>% 
  group_by(area) %>% 
  select(area,sta2, year_2014, year_2015, year_2016) %>% 
  mutate(tot_area=sum(year_2014,year_2015,year_2016),
         ratio=(year_2014+year_2015+year_2016)/tot_area*100) %>% 
  arrange(area)

income2
```


#### 그래프로 나타내기

`x`축에 지역, `y`축에 여행자 수 비율을 나타내고, 가구소득에 따라 색깔을 다르게 표현할 수 있는`fill`파라미터를 사용한다. 또한 `scale_fill_discrete(limits=c())`를 이용해 income의 순서를 바꾼다. 마지막으로 `y축`에 비해 `x축` 변수가 많으므로 `x`축과 `y`축의 위치를 변경하는 `coor_flip()`함수와 `ggtitle()`을 이용해 그래프 제목을 넣어준다.

``` {r}
ggplot(data = income2, aes(x=area, y=ratio, fill=sta2)) + 
  geom_col() +
  scale_fill_discrete(limits=c("50만원미만", "50-100만원미만", "100-200만원미만", "200-300만원미만", "300-400만원미만", "400-500만원미만", "500-600만원미만", "600만원이상"))+
  coord_flip()+
  ggtitle('소득별 여행지-여행자 수')
```



출력된 그래프를 보면 지역에 따라 대체적으로 비슷한 모양의 비율 분포가 나타난다는 것을 확인할 수 있었다. 다만 세종의 경우 다른 지역에 비해 '300~400만원미만'의 가구소득에 해당하는 여행자 수가 많았다.



### [5] 연도 및 지역별 학력-여행자 수의 관계 분석

#### 1. 학력별 연도에 따른 국내 여행자수 평균 비교

새로운 분석을 위해 데이터 복사 후 필요한 항목들만 추출해 새로운 변수를 만든다.

``` {r}
travel_new4 <- travel

total <- travel_new4[1:17,3:6]

man <- travel_new4[18:34,3:6]

woman <- travel_new4[35:51, 3:6]

elementary <- travel_new4[375:391, 3:6]

middle <- travel_new4[392:408, 3:6]

high <- travel_new4[409:425, 3:6]

college <- travel_new4[426:442, 3:6]        ##전문대 재/졸

university <- travel_new4[443:459, 3:6]     ##대학교 재/졸

graduate <- travel_new4[460:476, 3:6]    ##대학원 재/졸
```

`cbind()`를 이용해 각 항목에서 연도별 데이터를 추출해서 합친다.

``` {r}
#2014년 데이터 
school_2014 <- cbind(man[,c(1,2)], woman[,2], elementary[,2], middle[,2], high[,2], college[,2], university[,2], graduate[,2])
school_2014
```


``` {r}
names(school_2014) <- c("city", "man", "woman", "elementary", "middle", "high", "college", "university", "graduate")
school_2014   ##칼럼 이름 설정
```

   

``` {r}
#2015년 데이터
school_2015 <- cbind(man[,c(1,3)], woman[,3], elementary[,3], middle[,3], high[,3], college[,3], university[,3], graduate[,3])

names(school_2015) <- c("city", "man", "woman", "elementary", "middle", "high", "college", "university", "graduate")
school_2015
```

    

``` {r}
#2016년 데이터
school_2016 <- cbind(man[,c(1,4)], woman[,4], elementary[,4], middle[,4], high[,4], college[,4], university[,4], graduate[,4])

names(school_2016) <- c("city", "man", "woman", "elementary", "middle", "high", "college", "university", "graduate")
school_2016
```

    
`mutate()`함수를 이용해 위에서 만든 연도별 데이터에 "연도" 변수 추가한 뒤 `bind_rows()`를 이용해 다시 합쳐준다.

``` {r}
school_2014 <- school_2014 %>% 
  mutate(year="2014")

school_2015 <- school_2015 %>% 
  mutate(year="2015")

school_2016 <- school_2016 %>% 
  mutate(year="2016")

school <- bind_rows(school_2014, school_2015, school_2016)
school
```

    

연도별로 학력 대비 여행자 수의 평균을 비교해보려 한다. `group_by()`를 이용해 year을 나누고 각 학력 별 평균을 구해 새로운 변수를 생성한다.

``` {r}
school_year <- school %>% 
  group_by(year) %>% 
  summarise(mean_e = mean(elementary),
            mean_m = mean(middle),
            mean_h = mean(high),
            mean_c = mean(college),
            mean_u = mean(university),
            mean_g = mean(graduate)) 

school_year
```

    
그래프를 만들기 위한 데이터 구성을 변경한다. 학력별 데이터를 추출한 뒤 `mutate()`와 `names()` 함수를 이용해 변수명을 새로 설정하고 `bind_rows()`를 이용해 데이터를 추가한다.

``` {r}
school_yearE <- school_year[,1:2]
school_yearE <- school_yearE %>% 
  mutate(meanType="E")
names(school_yearE) <- c("year",  "mean",   "meanType")
school_yearE  ##초등학교를 졸업한 사람들의 연도별 평균 
```
    

``` {r}
school_yearM <- school_year[,c(1,3)]
school_yearM <- school_yearM %>% 
  mutate(meanType="M")
names(school_yearM) <- c("year",  "mean",   "meanType")
school_yearM  ##중학교를 졸업한 사람들의 연도별 평균
```


``` {r}
school_yearH <- school_year[,c(1,4)]
school_yearH <- school_yearH %>% 
  mutate(meanType="H")
names(school_yearH) <- c("year",  "mean",   "meanType")
school_yearH  ##고등학교를 졸업한 사람들의 연도별 평균
```


``` {r}
school_yearC <- school_year[,c(1,5)]
school_yearC <- school_yearC %>% 
  mutate(meanType="C")
names(school_yearC) <- c("year",  "mean",   "meanType")
school_yearC  ##전문대학을 졸업한 사람들의 연도별 평균
```

    
``` {r}
school_yearU <- school_year[,c(1,6)]
school_yearU <- school_yearU %>% 
  mutate(meanType="U")
names(school_yearU) <- c("year",  "mean",   "meanType")
school_yearU  ##대학교를 졸업한 사람들의 연도별 평균
```


``` {r}
school_yearG <- school_year[,c(1,7)]
school_yearG <- school_yearG %>% 
  mutate(meanType="G")
names(school_yearG) <- c("year",  "mean",   "meanType")
school_yearG  ##대학원을 졸업한 사람들의 연도별 평균
```


``` {r}
totalYear <- bind_rows(school_yearE, school_yearM, school_yearH, school_yearC, school_yearU, school_yearG)  ##데이터 합치기 
totalYear
```

위에서 만든 데이터를 이용한 막대그래프를 만든다. `x축`은 meanType, `y축`은 mean으로 설정하고 `scale_x_discrete(limits=c())` 함수를 이용해 `x축` 변수의 순서를 설정해준다.

``` {r}
##막대그래프 만들어서 비교하기 
ggplot(data=totalYear, aes(x=meanType, y= mean, fill=year)) +
  geom_col()+
  scale_x_discrete(limits=c("E", "M","H","C","U","G"))
```



위의 그래프는 학력별 년도에 따른 평균 여행자 수를 파악할 수 있다. 전체 그래프의 순서대로는 "고등학교", "대학교", "전문대", "중학교", "초등학교","대학원" 졸업 순으로 여행자 수가 많은 것으로 나타났다.  그 안에서 연도별로 파악했을때, 대체적으로 비슷한 크기의 평균 여행 횟수가 나타난다는 것을 파악할 수 있었다. 결과적으로 이 그래프를 통해서는 고등학교를 졸업한 학력의 여행자수와 대학교를 졸업한 학력의 여행자의 수가 다른 학력에 비해 현저히 높은 수치를 보이고 있다는 것을 알수있으며, 가장 높은 사람의 수는 고등학교를 졸업한 학력의 여행자였고, 가장 낮은 사람의 수는 대학원을 졸업한 학력의 여행자이다.


#### 2. 학력별 여행지에 따른 국내 여행자수 평균 비교

지역별로 각 학력을 졸업한 사람의 수의 합을 구한다. `group_by()`를 이용해 `city`를 분류하고 `mutate()`를 통해 남녀 수를 합한 `total` 변수를 생성한다. 이후 총 인원 및 각 학력별 여행자 수의 총합을 구한 뒤 `arrange()`를 이용해 오름차순으로 정렬한다.

``` {r}
##1. 지역별로 각 학력을 졸업한 사람의 수의 합계 구하기
school_sum <- school %>% 
  group_by(city) %>% 
  mutate(total=man+woman) %>% 
  summarise(sum_t=sum(total),
            sum_e=sum(elementary),
            sum_m=sum(middle),
            sum_h=sum(high),
            sum_c=sum(college),
            sum_u=sum(university),
            sum_g=sum(graduate)) %>% 
  arrange((city)) 

school_sum
```

    

지역별로 각 학력을 졸업한 사람의 비율을 구한다. 위에서 구한 `school_sum`을 이용해 지역별로 분류하고 각 학력별 인원의 비율을 구한 뒤 오름차순으로 정렬한다.

``` {r}
school_ratio <- school_sum %>% 
  group_by(city) %>% 
  summarise(ratio_e = sum_e/sum_t*100,
            ratio_m = sum_m/sum_t*100,
            ratio_h = sum_h/sum_t*100,
            ratio_c = sum_c/sum_t*100,
            ratio_u = sum_u/sum_t*100,
            ratio_g = sum_g/sum_t*100) %>% 
  arrange((city)) 

school_ratio
```


그래프를 만들기 위한 데이터 구성을 변경한다. 지역별 데이터를 추출한 뒤 `mutate()`와 `names()` 함수를 이용해 변수명을 새로 설정하고 `bind_rows()`를 이용해 데이터를 추가한다.

``` {r}
school_ratioE <- school_ratio[,1:2]
school_ratioE <- school_ratioE %>% 
  mutate(ratio="ratio_e")
names(school_ratioE) <- c("city",  "ratio",   "ratioType")
school_ratioE
```

``` {r}
school_ratioM <- school_ratio[,c(1,3)]
school_ratioM <- school_ratioM %>% 
  mutate(ratio="ratio_m")
names(school_ratioM) <- c("city",  "ratio",   "ratioType")
school_ratioM
```

    
``` {r}
school_ratioH <- school_ratio[,c(1,4)]
school_ratioH <- school_ratioH %>% 
  mutate(ratio="ratio_h")
names(school_ratioH) <- c("city",  "ratio",   "ratioType")
school_ratioH
```

    
``` {r}
school_ratioC <- school_ratio[,c(1,5)]
school_ratioC <- school_ratioC %>% 
  mutate(ratio="ratio_c")
names(school_ratioC) <- c("city",  "ratio",   "ratioType")
school_ratioC
```


``` {r}
school_ratioU <- school_ratio[,c(1,6)]
school_ratioU <- school_ratioU %>% 
  mutate(ratio="ratio_u")
names(school_ratioU) <- c("city",  "ratio",   "ratioType")
school_ratioU
```


``` {r}
school_ratioG <- school_ratio[,c(1,7)]
school_ratioG <- school_ratioG %>% 
  mutate(ratio="ratio_g")
names(school_ratioG) <- c("city",  "ratio",   "ratioType")
school_ratioG
```


``` {r}
totalRatio <- bind_rows(school_ratioE, school_ratioM, school_ratioH, school_ratioC, school_ratioU, school_ratioG)

totalRatio
```


위에서 만든 데이터를 이용한 막대그래프를 만든다. `x축`은 city, `y축`은 ratio, `fill`은 ratioType으로 설정한다.

``` {r}
ggplot(data=totalRatio, aes(x=city, y=ratio, fill=ratioType )) +
  geom_col()+
  coord_flip()
```



결과 그래프를 보면 지역에 따라 대체적으로 비숫한 학력별 여행 비율이 나타난다는 것을 확인할 수 있었다. 전체적인 모양은 고등학교를 졸업한사람과 대학교를 졸업한 사람들이 여행의 비율이 높은것으로 나타났다. 이러한 결과는 앞서 분석하였던 연도별과 유사한 결과이다. 세종시를 방문한 사람들의 비율에서는 전문대학을 졸업한 사람들의 비율이 2번째로 높게 나타났다. 이는 다른 지역과 비교해보았을때 높은 비율이라고 볼 수 있다.


###<결론_논의(한계점, 비판점), 추후 분석 방향>

지금까지의 데이터 분석으로 우리는 2014~2016년 국내 여행지별 국내여행 참가자 수의 특징들을 살펴볼 수 있었다. 분석의 특징은 성별측면에서는 대체적으로 여성의 여행자 수가 남성에 비해 많다는 것을 알수 있다. 연령, 소득측면에서는 대체적으로 높아질수록 여행을 참가하는 수는 증가한다는 것을 목격할 수 있었다. 이는 연령, 소득이 높은 사람의 경우 여행에 대한 선호가 매우 높다는 것을 방증하고 있다. 특히 60대 이상의 모집단 경우 여행에 대한 선호가 가장 높은 것으로 밝혀졌다. 이는 일반적으로 “은퇴 후 자신이 쌓아놓았던 소득을 여행을 통해 소비하는 성향이 있다”라는 명제를 사실로 증명해주고 있다. 직업이나 학력같은경우는 연도별, 지역별에 따라 특정 분야에서의 여행자의 수가 많이 나타났다는 것을 알아 볼 수 있다. 하지만 이번 데이터 분석에는 한계점이 분명히 존재한다. 

첫 째, 본 데이터는 국내여행 참가자 수를 기록만 있고 해외여행 참가자 수 기록은 빠져있다. 해외여행 참가자 수가 국내여행 참가자 수와는 다른 성향을 보여줄 수도 있기 때문에 완전한 데이터를 구축하고 있지 않고 있다.

둘 째, 연령, 소득이 대체적으로 높아질수록 여행을 참가하는 수는 증가한다고 볼 수 있지만 이는 국내여행 참가자 수의 특징을 완벽하게 설명해내지는 않는다. 한가지 예로, 이번 분석에서 연령별로 20대와 30대의 국내 여행자의 수가 적다는 것을 파악할 수 있었다. 20대와 30대의 사람들은 국내여행보다는 해외여행을 더 선호한다는 등의 다른 변수들이 있을 수 있기 때문에 나타난 결과일 수도 있다. 즉 '해외여행 수치'라는 다른 변수가 포함될 경우 결과값이 크게 달라질 수도 있다. 즉 여행자 수는 다양한 요인에 의해서 변동할 수 있기 때문에 쉽게 결론지을 수 없다.

그러므로 추후에 국내여행자 참가자와 더불어 해외여행 참가자의 데이터를 함께 분석함으로써 조금 더 다양하고 명확한 결론을 추론할 수 있을 것이다. 국내 여행자 수와 해외 여행자 수를 서로 비교해 봄으로써 전반적으로 최근에 유행을 하고 있는 해외여행에 대한 수치 그리고 연령별 해외여행 수치 등 폭 넓은 주제로 이어질 수 있다.